
==============
Проверка кода
==============

В pgCodeKeeper реализована возможность проверки качества SQL кода, которая позволяет верифицировать код по стилистическим и базовыми правилам. Список правил для проверки хранится в файле rules.properties.

Список правил
~~~~~~~~~~~~~
Стилистические правила.
Могут принимать значение true - включить проверку или false - выключить проверку (дефолтное значение).

- **check_indents** - проверка отступов.
- **check_quotes_in_table_column** - проверка наличия кавычек в имени столбца таблицы.
- **check_semicolon_after_simple_sql** - проверка символа ; после простого sql-выражения.
- **check_space_after_if**  - проверка наличия пробела после if.
- **check_space_on_math** - проверка наличия пробелов до и после математических выражений. 
- **check_space_after_comma** - проверка наличия пробела после запятой.


Базовые правила.

- **deny_grant** - проверка на группу, которой выдаются права.
- **check_case_without_else** - проверка использования else в блоке case. Может быть значение true или false (дефолтное значение).
- **check_temp_table** - проверка создания таблицы. Допустимо создание только временной таблицы.
- **cyclomatic_complexity** - проверка сложности кода. Код считается сложным если в нем вложенность больше указанного значения.
- **indent_size** - дефолтное значение отступа.
- **allowed_function_start** - проверка первых символов тела функции. Тело функции должно начинаться с этих символов. Например: $$, $_$, $BODY$.
- **max_function_length** - проверка на длину функции. Размер функции не должен быть больше указанного значения (количества строк).
- **max_function_params** - проверка количества входных параметров. Число параметров не должно быть больше указанного значения. Параметры с ключевым словом OUT при подсчете не учитываются.
- **method_count** - проверка количества выражений в функции. Количество выражений не должно быть больше указанного значения.

Использование
~~~~~~~~~~~~~
Верификацию можно запустить в cli версии pgCodeKeeper с опцией -v.

::

./pgcodekeeper-cli.sh -E  -v --ruleset {ruleset} --sources {sources}

где **{ruleset}** - путь к файлу с правилами, **{sources}** - путь к директории или файлу с исходниками для проверки.

Пример:

::

./pgcodekeeper-cli.sh -v --ruleset /home/user/rules.properties --sources /home/user/functions
